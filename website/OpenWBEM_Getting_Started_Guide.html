<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<HTML>
<HEAD>
	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
	<TITLE></TITLE>
	<META NAME="GENERATOR" CONTENT="OpenOffice.org 1.1.3  (Linux)">
	<META NAME="CREATED" CONTENT="20030409;16104600">
	<META NAME="CHANGED" CONTENT="20041209;15021300">
	<STYLE>
	<!--
		@page { size: 8.5in 11in; margin-left: 1.25in; margin-right: 1.25in; margin-top: 1in; margin-bottom: 1in }
		P { margin-bottom: 0.08in }
		H1 { margin-bottom: 0.08in }
		H1.western { font-family: "Luxi Sans", sans-serif; font-size: 16pt }
		H1.cjk { font-size: 16pt }
		H1.ctl { font-size: 16pt }
		H2 { margin-bottom: 0.08in }
		H2.western { font-family: "Luxi Sans", sans-serif; font-size: 14pt; font-style: italic }
		H2.cjk { font-family: "HG Mincho Light J"; font-size: 14pt; font-style: italic }
		H2.ctl { font-family: "Arial Unicode MS"; font-size: 14pt; font-style: italic }
		H3 { margin-bottom: 0.08in }
		H3.western { font-family: "Luxi Sans", sans-serif }
		H3.cjk { font-family: "HG Mincho Light J" }
		H3.ctl { font-family: "Arial Unicode MS" }
	-->
	</STYLE>
</HEAD>
<BODY LANG="en-US" DIR="LTR">
<H1 CLASS="western">OpenWBEM Getting Started Guide</H1>
<P>Author: Dan Nuffer</P>
<P>Last update: 12/09/04</P>
<P><BR><BR>
</P>
<DIV ID="Table of Contents1" DIR="LTR">
	<DIV ID="Table of Contents1_Head" DIR="LTR">
		<P STYLE="margin-top: 0.17in; page-break-before: always; page-break-after: avoid">
		<FONT FACE="Luxi Sans, sans-serif"><FONT SIZE=4 STYLE="font-size: 16pt"><B>Table
		of Contents</B></FONT></FONT></P>
	</DIV>
	<P STYLE="margin-bottom: 0in">OpenWBEM Getting Started Guide	1</P>
	<P STYLE="margin-bottom: 0in">1. OpenWBEM Overview &amp; Concepts	3</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Genesis	3</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Overview	3</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Features	3</P>
	<P STYLE="margin-bottom: 0in">2. Installation	3</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Pre-Requisites	3</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Optional Feature
	Pre-Requisites	3</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">The Installation	4</P>
	<P STYLE="margin-bottom: 0in">3. Configuration	4</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Configuring
	authentication	5</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">PAM	5</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">PAM Command
	Line	5</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Simple	6</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">AIX	6</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Non-Authenticationg	6</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Custom	7</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Digest	7</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">OWLocal	7</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">SSL	8</P>
	<P STYLE="margin-bottom: 0in">4. Execution	8</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Create
	Namespace(s)	8</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Import Schema(s)	9</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Install
	Providers	9</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Automatic
	Provider Registration	9</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Provider
	Qualifier	10</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Using CIM
	Clients	10</P>
	<P STYLE="margin-bottom: 0in">5. Client API	11</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Overview	11</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Building/Compiling/Linking	11</P>
	<P STYLE="margin-bottom: 0in">6. Building Providers	11</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Overview	11</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Instance	11</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Secondary
	Instance	12</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Associator	12</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Method	12</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Indication	12</P>
	<P STYLE="margin-left: 0.2in; margin-bottom: 0in">Provider
	Development Process	13</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Extend Schema	13</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Use CodeGen	13</P>
	<P STYLE="margin-left: 0.39in; margin-bottom: 0in">Finish writing
	provider	13</P>
</DIV>
<P><BR><BR>
</P>
<H1 CLASS="western">1. OpenWBEM Overview &amp; Concepts</H1>
<H2 CLASS="western">Genesis</H2>
<P>OpenWBEM was started at Caldera in early 2001. It was intended to
become part of the Volution Manager product.  It was open sourced in
the desire to help increase the compatiblity of management products,
especially for Linux. It is now maintained by a variety of various
companies and individuals.  Dan Nuffer is the project lead.</P>
<H2 CLASS="western">Overview</H2>
<P>OpenWBEM is a software suite that is a mature implementation of
the DMTF CIM and WBEM standards. Components include a CIM Object
Manager (CIMOM), a CIM Client API, a CIM Listener API, a WBEM Query
Language (WQL) engine.</P>
<H2 CLASS="western">Features</H2>
<P>See openwbem.org for a nice list.</P>
<H1 CLASS="western">2. Installation</H1>
<H2 CLASS="western">Pre-Requisites</H2>
<UL>
	<LI><P>OpenWBEM is written in C++, and has been developed on gcc. 
	It also can be compiled by most current C++ compilers, include
	Microsoft Visual C++ 7.1, IBM's VisualAge for C++, and HP's aC++</P>
	<LI><P>pthreads.</P>
	<LI><P>GNU make</P>
	<LI><P>One some OSs you may need GNU versions of standard Unix tools
	because the vendor provided tools are buggy or have hard-coded
	limits like 2048 line lengths or other such nonsense.</P>
</UL>
<H2 CLASS="western">Optional Feature Pre-Requisites</H2>
<UL>
	<LI><P>flex – Only if you obtained the source from CVS, or if you
	need to modify the mof or wql lexers.</P>
	<LI><P>bison – Only if you obtained the source from CVS, or if you
	need to modify the mof or wql parsers.</P>
	<LI><P>perl with embedding headers and libraries – If you want to
	use the perl provider interface.</P>
	<LI><P>PAM libraries – If you want to use the PAM authentication
	module.  These are part of glibc on Linux.  
	</P>
	<LI><P>PAM development headers – If you want to build the PAM
	authentication module.</P>
	<LI><P>zlib – If you want to enable &amp; use http compression.</P>
	<LI><P>slp (e.g. OpenSLP) – If you want to use the slp provider to
	advertise or the client api to discover slp cimom advertisements.</P>
	<LI><P>openssl – If you want to use https. Highly recommended.</P>
</UL>
<H2 CLASS="western">The Installation</H2>
<P>First download and extract the OpenWBEM source code.  Then run the
configure script: <FONT FACE="Courier, monospace">./configure</FONT> 
There are quite a few options you can pass to the configure script
that are used to enable/disable certain optional features, or to tell
it where to find headers and libraries if they aren't in the standard
locations.  Use the --<FONT FACE="Courier, monospace">help</FONT>
flag to get a list of the options.  If you are building a copy to do
development work, it is highly recommended you use the
<FONT FACE="Courier, monospace">–enable-debug-mode</FONT> option. 
After configure is finished, you can run <FONT FACE="Courier, monospace">make</FONT>
to build.  Verify that everything is working, and run <FONT FACE="Courier, monospace">make
check</FONT>.  Run <FONT FACE="Courier, monospace">make install</FONT>
to install OpenWBEM on your system.  Having it installed is not
required, but will make it easier to use since the binaries and
libraries will be in the <FONT FACE="Courier, monospace">PATH</FONT>.</P>
<P><BR><BR>
</P>
<P>There is also an RPM spec file available.  You can build the
OpenWBEM RPMs by executing: <FONT FACE="Courier, monospace">rpmbuild
-ta openwbem-&lt;version&gt;.tar.gz</FONT>.  Or if you have already
extracted the tarball and run configure, run <FONT FACE="Courier, monospace">make
rpm</FONT>, and the output will be placed under the <FONT FACE="Courier, monospace">rpmbuild</FONT>
directory. This will generate an openwbem and openwbem-devel rpm. You
can then install them by running <FONT FACE="Courier, monospace">rpm
-i &lt;rpm filename&gt;</FONT>.  The RPM provides some additional
files that aren't installed otherwise on Linux.  These include the
init script (<FONT FACE="Courier, monospace">/etc/init.d/owcimomd</FONT>),
the PAM configuration file (<FONT FACE="Courier, monospace">/etc/pam.d/openwbem</FONT>),
and some miscellaneous documentation.</P>
<H1 CLASS="western">3. Configuration</H1>
<P>The OpenWBEM cimom (owcimomd) can be passed 3 different command
line arguments.</P>
<UL>
	<LI><P>-h prints the help.  
	</P>
	<LI><P>-d tells owcimomd to run in debug mode.  This causes it to
	<B>not</B> fork into the background and detach from the terminal
	(daemonizing).  It will also print all log messages to the console
	in addition to whatever logger is configured.</P>
	<LI><P>-c &lt;config filename&gt; specifies which config file to
	use.  By default owcimomd will use the config file in
	<FONT FACE="Courier, monospace">${sysconfdir}/openwbem/openwbem.conf</FONT>
	. <FONT FACE="Courier, monospace">${sysconfdir}</FONT> defaults to
	<FONT FACE="Courier, monospace">/usr/local/etc</FONT>, but can be
	changed by telling the configure script to use a different prefix or
	sysconfdir (e.g. <FONT FACE="Courier, monospace">--sysconfdir=/etc</FONT>).
	This option allows the user to override the default and manually
	specify the config file to use.</P>
</UL>
<P>The owcimomd config file contains many options which can be used
to modify it's behavior.  Most are set to reasonable defaults.  You
probably won't need to change any of the options that refer to
directories.  Some you may wish to configure are those related to
authorization, logging, or optional features.  The config file
contains explanations for all available options. The OpenWBEM
philosophy is that all configuration is stored in one centralized
location: the config file. This is why there are only 3 command line
options, and no environment variables affect the behavior of
owcimomd.</P>
<H2 CLASS="western">Configuring authentication</H2>
<P>Currently there are 3 supported HTTP authentication methods. 
Basic, Digest and OWLocal.</P>
<P>If Basic is used, then you may choose to use an authentication
module. Available modules include: PAM, PAM command line, Simple, AIX
authenticator, and non authenticating.  OpenWBEM also supports custom
authentication modules.</P>
<P>The <FONT FACE="Courier, monospace">owcimomd.allowed_users</FONT>
config item is the simplest form of access control, and is applied
after the authentication module has authenticated a user. It is a
space delimited list of the users who are allowed to access the
cimom. To allow all users, use <FONT FACE="Courier, monospace">*</FONT>.</P>
<H3 CLASS="western">PAM</H3>
<P>This method uses the PAM (Pluggable Authentication Modules) system
api.  This means that the cimom will use the system's authentication.
 The client will have to use the same username and password they
would use to log in to the system.  To use this:</P>
<UL>
	<LI><P>Set the <FONT FACE="Courier, monospace">owcimomd.authentication_module</FONT>
	config item to point to the <FONT FACE="Courier, monospace">libpamauthentication.so</FONT>
	library file.  
	</P>
	<LI><P>The <FONT FACE="Courier, monospace">pam.allowed_users</FONT>
	config item to a space delimited list of the users who are allowed
	to access the cimom. To allow all users, put in <FONT FACE="Courier, monospace">*</FONT>.
	This option is deprecated in favor of the more general
	<FONT FACE="Courier, monospace">owcimomd.allowed_users</FONT>
	option.</P>
	<LI><P>On Linux, install the openwbem PAM config file.  Copy
	<FONT FACE="Courier, monospace">etc/pam.d/openwbem</FONT> to
	<FONT FACE="Courier, monospace">/etc/pam.d/</FONT></P>
</UL>
<P>To build the PAM authentication module, you must have the PAM
development headers installed.  They are not installed by default in
many versions of Linux.  If you find that the <FONT FACE="Courier, monospace">libpamauthentication.so</FONT>
file was not built, this is because the OpenWBEM configure script
will automatically detect if the PAM headers are there or not, and
only build the PAM authentication module if they are installed.  If
you find this happened to you, and you want to remedy the situation,
install the headers (commonly in an RPM called pam-devel), then
remove the <FONT FACE="Courier, monospace">config.cache</FONT> file
generated by the configure script, and then re-run configure and
rebuild.</P>
<P>When using PAM, the HTTP Basic authentication scheme is used,
meaning the password is sent in an insecure fashion over the wire. 
To prevent sniffers on the Internet from obtaining your credentials
you must use SSL together with the PAM authentication module.  This
may not be a concern in a trusted environment.</P>
<H3 CLASS="western">PAM Command Line</H3>
<P>This method is the same as PAM. The difference is that an external
binary (OW_PAMAuth) is called to perform the authentication. The
reasons to use this instead of PAM is if the system's pam APIs are
not thread safe or leak memory. Some older versions of Linux (from
2001 and earlier) are known to leak memory. To use this:</P>
<UL>
	<LI><P>Set the <FONT FACE="Courier, monospace">owcimomd.authentication_module</FONT>
	config item to point to the <FONT FACE="Courier, monospace">libpamauthenticationcl.so</FONT>
	library file.</P>
	<LI><P>The other considerations for PAM also apply.</P>
</UL>
<H3 CLASS="western">Simple</H3>
<P>The simple authentication module is backed by a file where each
line contains a user name and password separated by a colon. <BR><BR>An
example file is like this:</P>
<P> <BR><FONT FACE="Courier, monospace">username1:password1
<BR>username2:password2</FONT></P>
<P><BR><BR>
</P>
<P>To use this:</P>
<UL>
	<LI><P>Set the <FONT FACE="Courier, monospace">owcimomd.authentication_module</FONT>
	config item to point to the <FONT FACE="Courier, monospace">libsimpleauthentication.so</FONT>
	library file.  
	</P>
	<LI><P>Set the <FONT FACE="Courier, monospace">simple_auth.password_file</FONT>
	config item to point to the password file you have created.</P>
</UL>
<P>When using the simple authentication method, the HTTP Basic
authentication scheme is used, meaning the password is sent in an
insecure fashion over the wire.  To prevent sniffers on the Internet
from obtaining your credentials you must use SSL together with the
simple authentication module.  This may not be a concern in a trusted
environment.</P>
<H3 CLASS="western">AIX</H3>
<P>The AIX authentication module uses the AIX authenticate(), which
is a precursor to PAM. The system's user database will be used. Newer
versions of AIX have PAM by default, so you may want to use PAM if
possible. <BR><BR>To use this:</P>
<UL>
	<LI><P>Set the <FONT FACE="Courier, monospace">owcimomd.authentication_module</FONT>
	config item to point to the <FONT FACE="Courier, monospace">libaixauthentication.so</FONT>
	library file.  
	</P>
</UL>
<P>When using the AIX authentication method, the HTTP Basic
authentication scheme is used, meaning the password is sent in an
insecure fashion over the wire.  To prevent sniffers on the Internet
from obtaining your credentials you must use SSL together with the
simple authentication module.  This may not be a concern in a trusted
environment.</P>
<H3 CLASS="western">Non-Authenticationg</H3>
<P>The non-authenticating module authenticates all users. You may
wonder what benefit it has over just setting
<FONT FACE="Courier, monospace">owcimomd.allow_anonymous=true</FONT>?
The difference is that the client is required to provide credentials,
and the username and password are stored in the <FONT FACE="Courier, monospace">OperationContext</FONT>.
This isn't very secure, but if you want to allow anybody to
authenticate, but actually need the principal and credential for
logging purposes, this may suit your purpose.</P>
<P>To use this:</P>
<UL>
	<LI><P>Set the <FONT FACE="Courier, monospace">owcimomd.authentication_module</FONT>
	config item to point to the <FONT FACE="Courier, monospace">libnonauthenticatingauthentication</FONT>.<FONT FACE="Courier, monospace">so</FONT>
	library file.  
	</P>
</UL>
<P>When using the non-authenticating authentication method, the HTTP
Basic authentication scheme is used, meaning the password is sent in
an insecure fashion over the wire.  To prevent sniffers on the
Internet from obtaining your credentials you must use SSL together
with the simple authentication module.  This may not be a concern in
a trusted environment.</P>
<H3 CLASS="western">Custom</H3>
<P>Create a class that implements the AuthenticatorIFC interface and
compile it into a shared library.  Point the config file at it and
you're done.</P>
<P>When using a custom authentication method, the HTTP Basic
authentication scheme is used, meaning the password is sent in an
insecure fashion over the wire.  To prevent sniffers on the Internet
from obtaining your credentials you must use SSL together with the
simple authentication module.  This may not be a concern in a trusted
environment.</P>
<H3 CLASS="western">Digest</H3>
<P>The digest authentication mechanism is built into the http server,
and bypasses the pluggable owcimomd authentication module.  To turn
on digest authentication, set the <FONT FACE="Courier, monospace">http_server.use_digest</FONT>
config item to true.  Digest uses cryptographic hashing and other
mechanisms to prevent discovery of passwords.  Because of this, it
cannot integrate with system passwords. The digest authentication
module requires you create a password file using the <FONT FACE="Courier, monospace">owdigestgenpass</FONT>
utility.  Here is an example of how to use it:</P>
<P><FONT FACE="Courier, monospace">owdigestgenpass -l user1 -f
/the/password/file</FONT></P>
<P>Enter the password when prompted.  If you aren't running it on the
same computer as the cimom, you can also use the -h flag to specify
the cimom computer's hostname. To inform owcimomd of the digest
password file, set the <FONT FACE="Courier, monospace">http_server.digest_password_file</FONT>
config item.</P>
<P>Digest authentication protects the password over an unencrypted
(non-SSL) connection.  Attackers will be unable to obtain the
password. Digest also prevents attackers from doing a replay attack.
However, the data stream will not be encrypted.</P>
<H3 CLASS="western">OWLocal</H3>
<P>This is an HTTP authentication mechanism that is designed to be
used by a client and server which are on the same system. The
mechanism is specified in doc/local_authentication.txt. This allows
clients to authenticate without providing a password, and owcimomd
trusts the hosting operating system has properly authenticated the
user.</P>
<P>To use this:</P>
<UL>
	<LI><P>Set the config item <FONT FACE="Courier, monospace">http_server.allow_local_authentication
	= true</FONT></P>
</UL>
<H3 CLASS="western">SSL</H3>
<P>OpenWBEM will build in SSL client and server support if the
configure scripts finds the openssl development headers and
libraries.  The <FONT FACE="Courier, monospace">http_server.https_port</FONT>
config item specifies which port the https server will listen on.  If
set to -1, https will be disabled.  If not specified, the default is
port 5989 which is the IANA assigned port for CIM-XML over https.</P>
<P>To use SSL you need to setup a SSL host key and certificate. If
you are just testing, or doing development, you can use the test file
the comes with OpenWBEM: <FONT FACE="Courier, monospace">test/acceptance/testfiles/hostkey+cert.pem</FONT>
<BR><BR>Otherwise you can generate your own using a SSL key and
certificate tool such as openssl, or even get one signed by a your
local CA or a recognized CA (e.g. Verisign).  The file has to contain
both the server key and certificate in pem format.</P>
<P>You may want to use the provided <FONT FACE="Courier, monospace">owgencert</FONT>
script to create a self signed certificate and key.  <BR><BR>Make
sure the config item <FONT FACE="Courier, monospace">http_server.SSL_cert</FONT>
points to the file.</P>
<P><BR><BR>
</P>
<H1 CLASS="western">4. Execution</H1>
<P>During development I almost always run owcimomd in debug mode (use
the -d command line argument).  In production, it should be run as a
normal system daemon.  There is a Linux init script available
(<FONT FACE="Courier, monospace">etc/init/owcimomd</FONT>) which
works on most Linux distributions.  The init script assumes openwbem
has been <FONT FACE="Courier, monospace">./configure</FONT>'d with
the following arguments: <FONT FACE="Courier, monospace">--prefix=/usr
--sysconfdir=/etc --localstatedir=/var/lib</FONT></P>
<H2 CLASS="western">Create Namespace(s)</H2>
<P>owcimomd always has a namespace named <FONT FACE="Courier, monospace">root</FONT>.
 OpenWBEM supports a<SPAN LANG="en-US"> hierarchical </SPAN>view of
namespaces, using the <FONT FACE="Courier, monospace">__Namespace</FONT>
class.  The DMTF has deprecated <FONT FACE="Courier, monospace">__Namespace</FONT>
in lieu of <FONT FACE="Courier, monospace">CIM_Namespace</FONT>. 
OpenWBEM supports  <FONT FACE="Courier, monospace">CIM_Namespace</FONT>
if the class has been created, and it provides a flat view of
namespaces. Enumerating instances of the class will return an
instance for each namespace in the cimom.  The CIM Operations over
HTTP spec recommends that <FONT FACE="Courier, monospace">CIM_Namespace</FONT>
always be available in the <FONT FACE="Courier, monospace">root</FONT>
namespace.  It is common practice to use <FONT FACE="Courier, monospace">root/cimv2</FONT>
as the namespace to hold version 2 of the CIM schema.  You can create
namespaces using any CIM client such as the SNIA browser.  OpenWBEM
provides a utility named <FONT FACE="Courier, monospace">owcreatenamespace</FONT>
which can create a namespace.  Here is an example of how to create
the <FONT FACE="Courier, monospace">root/cimv2</FONT> namespace on
the cimom running on the same machine: 
</P>
<P><FONT FACE="Courier, monospace">owcreatenamespace -u
http://localhost/ -n root/cimv2</FONT></P>
<H2 CLASS="western">Import Schema(s)</H2>
<P>You use <FONT FACE="Courier, monospace">owmofc</FONT> to import
mof classes and instances into the cimom.  
</P>
<P><BR><BR>
</P>
<P>It is recommended that the CIM_Interop schema be present in the
<FONT FACE="Courier, monospace">root</FONT> namespace.  Run the
following commands to accomplish this:</P>
<P><FONT FACE="Courier, monospace">owmofc -u http://localhost/cimom
-n root CIM_Core28.mof</FONT></P>
<P><FONT FACE="Courier, monospace">owmofc -u http://localhost/cimom
-n root CIM_Event28.mof</FONT></P>
<P><FONT FACE="Courier, monospace">owmofc -u http://localhost/cimom
-n root Physical28_Package.mof</FONT></P>
<P><FONT FACE="Courier, monospace">owmofc -u http://localhost/cimom
-n root System28_SystemElements.mof</FONT></P>
<P><FONT FACE="Courier, monospace">owmofc -u http://localhost/cimom
-n root CIM_Interop28.mof</FONT></P>
<P><FONT FACE="Courier, monospace">owmofc -u http://localhost/cimom
-n root OpenWBEM_Interop.mof</FONT></P>
<P>As of this writing the current version of the schema is 2.8. 
Substitute the version of the schema that you wish to use in the
above commands.</P>
<P><BR><BR>
</P>
<P>For all versions of OpenWBEM:</P>
<P>You will have to import the schema into the namespace you wish to
use (<FONT FACE="Courier, monospace">root/cimv2</FONT> is
recommended):</P>
<P><FONT FACE="Courier, monospace">owmofc -u http://localhost/cimom
-n root/cimv2 CIM_Schema28.mof</FONT></P>
<P>Substitute the actual schema file you are using.  OpenWBEM 3.1.x
comes with the CIM 2.8 schema in the schemas/cim28 directory.  Other
versions can be downloaded from the DMTF at
http://dmtf.org/standards/standard_cim.php.</P>
<P>If you wish to use ACLs, create the <FONT FACE="Courier, monospace">root/security</FONT>
namespace and import <FONT FACE="Courier, monospace">OpenWBEM_Acl1.0.mof</FONT>.
 Refer to the ACL.HOWTO file if you want more information about ACLs.</P>
<H2 CLASS="western">Install Providers</H2>
<H3 CLASS="western">Automatic Provider Registration</H3>
<P>When OpenWBEM starts up, it will scan and load all provider
interfaces.  Each provider interface is given the opportunity to
automatically register any class/provider combos that its responsible
for with the provider manager.  Thus this behavior is dependent on
the provider interface.  The C++ provider interface will scan all
providers at start-up. It is currently not possible to dynamically
register a provider that uses this registration scheme.  The cimom
has to be restarted when one is added or removed.  It is not
necessary to create any special classes or instances to inform the
cimom of the provider, since it will be found when the cimom starts
up.</P>
<H3 CLASS="western">Provider Qualifier</H3>
<P>owcimomd has support for the provider qualifier and will continue
to support the provider qualifier as long as people still use it.</P>
<P>To use the provider qualifier, you should first find the class in
the CIM schema that most closely resembles what you want to model. 
Then you create a subclass for your object.  You attach a provider
qualifier to the class that identifies your provider.  For instance:</P>
<P><FONT FACE="Courier, monospace">[provider(“c++::acme_foo”)]</FONT></P>
<P><FONT FACE="Courier, monospace">class ACME_Foo : CIM_Foo</FONT></P>
<P><FONT FACE="Courier, monospace">{</FONT></P>
<P><FONT FACE="Courier, monospace">};</FONT></P>
<P>tells the cimom to look for <FONT FACE="Courier, monospace">libacme_foo.so</FONT>
when it needs to query the provider for the <FONT FACE="Courier, monospace">ACME_Foo</FONT>
class.  The value of the qualifier <FONT FACE="Courier, monospace">“c++::acme_foo”</FONT>
identifies both the provider type and the provider library name.  <FONT FACE="Courier, monospace">c++</FONT>
is the type, and <FONT FACE="Courier, monospace">acme_foo</FONT> is
the name.  Other provider interfaces have a different type.  To
install the provider, simply copy the provider library to the
appropriate directory.  The config item <FONT FACE="Courier, monospace">cppprovifc.prov_location</FONT>
specifies the directory.  It defaults to
<FONT FACE="Courier, monospace">/usr/local/lib/openwbem/c++providers</FONT>.
 Then import your mof into the cimom and your provider will be
available.  It is <B>not</B> necessary to restart the cimom.</P>
<H3 CLASS="western">Using CIM Clients</H3>
<P>OpenWBEM currently has utilities to:</P>
<UL>
	<LI><P>compile mof (owmofc)</P>
	<LI><P>generate a http digest password file (owdigestgenpass)</P>
	<LI><P>listen for indications (owcimindicationlistener)</P>
	<LI><P>create a namespace (owcreatenamespace)</P>
	<LI><P>delete a namespace (owdeletenamespace)</P>
	<LI><P>enumerate classes (owenumclasses)</P>
	<LI><P>enumerate class names (owenumclassnames)</P>
	<LI><P>enumerate namespaces (owenumnamespace)</P>
	<LI><P>enumerate qualifiers (enumqualifiers)</P>
	<LI><P>execute wql queries (owexecwql)</P>
</UL>
<P>owmofc and owdigestgenpass have man pages. For usage information
on any command, use the --help option.</P>
<H1 CLASS="western">5. Client API</H1>
<H2 CLASS="western">Overview</H2>
<P>OpenWBEM has all the necessary code to facilitate writing a CIM
client.  All the details of CIM/XML are abstracted.  There are also
utilities for sockets, threading, etc.  See the Doxygen generated API
docs if you need more information.</P>
<H2 CLASS="western">Building/Compiling/Linking</H2>
<P>The client API is broken up into various shared libraries to allow
developers to be able to pick and choose what subset of functionality
they need.</P>
<UL>
	<LI><P>libopenwbem.so – Common code as well as all CIM meta model
	classes.</P>
	<LI><P>libowclient.so – CIM client functionality.</P>
	<LI><P>libowxml.so – XML functionality used by the CIM/XML
	protocol code.</P>
	<LI><P>libowhttpcommon.so – HTTP functionality that is common
	between client and server.</P>
	<LI><P>libowhttpclient.so – HTTP client code.</P>
	<LI><P>libowhttpxmllistener.so – The CIM/XML Listener.</P>
	<LI><P>libowservicehttp.so – The HTTP server.  Used by the CIM/XML
	Listener.</P>
</UL>
<H1 CLASS="western">6. Building Providers</H1>
<H2 CLASS="western">Overview</H2>
<H3 CLASS="western">Instance</H3>
<P>Instance providers are responsible for handling the following
intrinsic methods for a certain class:</P>
<UL>
	<LI><P>EnumerateInstanceNames</P>
	<LI><P>EnumerateInstances - The default implementation calls
	enumInstanceNames() and then getInstance() for each name.</P>
	<LI><P>GetInstance</P>
	<LI><P>CreateInstance</P>
	<LI><P>ModifyInstance</P>
	<LI><P>DeleteInstance</P>
</UL>
<P>Typically, each instance (uniquely identified by it's keys)
represents one object to be managed.</P>
<P>If your provider is read-only, you can derive from
CppReadOnlyInstanceProvider and you don't need to implement create,
modify or delete. Also you can derive from CppSimpleInstanceProvider
and implement doSimpleEnumInstances(). enumInstances(), getInstance()
and enumInstanceNames() are all implemented by the base class.</P>
<H3 CLASS="western">Secondary Instance</H3>
<P>Secondary Instance providers aren't responsible to exposing
instances like instance providers are, but they are given the
opportunity to filter instances returned by enumInstances() or
getInstance().  They also get notified on createInstance(),
modifyInstance() and deleteInstance().</P>
<H3 CLASS="western">Associator</H3>
<P>Associator providers are responsible for handling the following
intrinsic methods for a certain association class:</P>
<UL>
	<LI><P>Associators</P>
	<LI><P>AssociatorNames</P>
	<LI><P>References</P>
	<LI><P>ReferenceNames</P>
</UL>
<P>With OpenWBEM, an dynamic association can be implemented with just
an instance provider, but it can be much more efficient to implement
the associator provider interface.  Associator providers should also
be instance providers so that the instance functions will work for
the association class.</P>
<P>For a simpler (albeit less powerful) provider, you can derive from
CppSimpleAssociatorProvider, which only requires the provider to
implement one function, and the other 4 standard functions are
implemented by the base class.</P>
<H3 CLASS="western">Method</H3>
<P>Method providers are responsible for handling any extrinsic
methods defined in a class.  It is common for an instance provider to
also be a method provider.</P>
<H3 CLASS="western">Indication</H3>
<P>Indication providers are responsible for generating indications.
There are two categories of indications, Life-cycle and alert.  See
the DMTF indication whitepaper for more info.  Life-cycle indications
are tied to a specific class, and so will usually be implemented as
an instance/indication provider.  OpenWBEM supports three models of
implementing indication providers:</P>
<UL>
	<LI><P>Instance Life-cycle: polled by the cimom – This is the
	easiest to implement, but also is more cpu and memory intensive than
	the other alternatives.  The cimom keeps a cached copy of all the
	instances of the class and every polling cycle will get the current
	set.  The differences in the sets between the cycles drive the
	generation of indications.</P>
	<LI><P>Separate thread – This is good for the case when a separate
	thread can block on an external event (such as a socket or kernel
	semaphore, etc.) and raise an indication whenever something happens.</P>
	<LI><P>Polled provider – This is good for the case where the
	provider has to poll for data (e.g. Check the free disk space every
	30 seconds)</P>
</UL>
<P>See the indication provider examples for more detail on these 3
approaches.</P>
<H2 CLASS="western">Provider Development Process</H2>
<H3 CLASS="western">Extend Schema</H3>
<P>The first step is to find the appropriate class in the standard
CIM schema that represents the element you want to model.  Next you
create a subclass for your object.  You can add properties and
methods that apply. Creating a subclass is done with mof (or you can
use the new rose plug-in available from the sblim project and
generate the mof).  The class may be dependent on others via
associations, so you may have multiple iterations of classes that
need to be instrumented.  If you implement non-association classes,
you also usually need to implement associations for them as well.</P>
<H3 CLASS="western">Use CodeGen</H3>
<P>Decide how much functionality your provider will need.  Is a
read-only instance provider good enough?  If you have methods you
need to implement, you will need to be an instance/method provider. 
If your class needs to be monitored for changes, you need to
implement the indication provider provider interface to send
indications.  Once you know what provider interfaces you'll need to
implement, you can select the appropriate CodeGen template, and then
generate stubs for your provider.  See the CodeGen README for more
information on how to use it. Unfortunately, as of this writing, the
templates for CodeGen are out of date and incomplete. If you write
some, please consider contributing it for others to use.</P>
<H3 CLASS="western">Finish writing provider</H3>
<P>Now you get to do the real work, interface with whatever you're
modeling and convert it into CIM objects.  Link your provider into a
shared library and you're set.</P>
</BODY>
</HTML>